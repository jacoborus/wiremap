<!doctype html>
<html class="no-js" lang="">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>wiretree - Lightweight email server with mustache templates support for messages</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="css/normalize.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link href="css/prism.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,800,600,700' rel='stylesheet' type='text/css'>
<style>#forkongithub a{background:#483e37;color:#fff;text-decoration:none;font-family:arial,sans-serif;text-align:center;font-weight:bold;padding:5px 40px;font-size:1rem;line-height:2rem;position:relative;transition:0.5s;}#forkongithub a:hover{background:#fff;color:#483e37;}#forkongithub a::before,#forkongithub a::after{content:"";width:100%;display:block;position:absolute;top:1px;left:0;height:1px;background:hsl(76, 21%, 52%);}#forkongithub a::after{bottom:1px;top:auto;}@media screen and (min-width:800px){#forkongithub{position:absolute;display:block;top:0;left:0;width:200px;overflow:hidden;height:200px;z-index:9999;}#forkongithub a{width:200px;position:absolute;top:60px;left:-60px;transform:rotate(-45deg);-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-o-transform:rotate(-45deg);box-shadow:4px 4px 10px rgba(0,0,0,0.8);}}</style>
    <!--[if lt IE 9]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <script>window.html5 || document.write('<script src="js/vendor/html5shiv.js"><\/script>')</script>
    <![endif]-->
</head>
<body>
<aside id="forkongithub"><a href="https://github.com/jacoborus/wiretree">Fork me on GitHub</a></aside>
<div class="container">
<h1 id="title"><img src="wiretree-logo.svg" alt="wiretree logo" title="wiretree logo"></h1>

<p class="subtitle">Elegant dependency injection framework for Node.js.</p>

<div class="githubs">
    <a class="github-button" href="https://github.com/jacoborus/wiretree" data-icon="octicon-star" data-count-href="/jacoborus/wiretree/stargazers" data-count-api="/repos/jacoborus/wiretree#stargazers_count">Star</a>
    <a class="github-button" href="https://github.com/jacoborus/wiretree/fork" data-icon="octicon-git-branch" data-count-href="/jacoborus/wiretree/network" data-count-api="/repos/jacoborus/wiretree#forks_count">Fork</a>
    <a class="github-button" href="https://github.com/jacoborus">Follow @jacoborus</a>
</div>
<article class="markdown-body entry-content" itemprop="mainContentOfPage">


<p>Wiretree creates a tree with your framework configuration, then it will start your app resolving each plugin of tree by passing one or more dependencies to it. Wiretree enables to extend apps by adding more plugins without changing configuration.</p>

<p>Plugins can be simple node.js modules or preconfigured (at resolve time) ones, they can require another plugins or modules as dependencies, as well as return their value asynchronously.</p>

<p>A Wiretree plugin constructor is a function exposed as 'wiretree' in a nodejs module, its dependencies are declared as its arguments, and the value of resolved plugin is the returned value of constructor function:</p>
<pre><code class="language-javascript">exports.wiretree = function (dependencyPlugin) {
    var myPlugin;
    // do something with myPlugin and dependencyPlugin
    // ...
    // and return your plugin
    return myPlugin;
};</code></pre>

<p>Plugin constructors can be resolved asynchronously by passing its value through <code>wtDone</code> (<code>wtDone</code> is injected by Wiretree):</p>

<pre><code class="language-javascript">exports.wiretree = function (wtDone) {
    doSomeAsyncOp( function (value) {
        // expose plugin
        wtDone( value );
    });
};</code></pre>


<h2>
<a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<pre class="pretty"><code>npm install wiretree</code></pre>

<h2>
<a id="user-content-api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<ul class="task-list">
<li><a href="#Wiretree">Wiretree</a></li>
<li><a href="#then">then</a></li>
<li><a href="#add">add</a></li>
<li><a href="#load">load</a></li>
<li><a href="#folder">folder</a></li>
<li><a href="#resolve">resolve</a></li>
</ul>

<p><a name="user-content-Wiretree"></a></p>

<h3>
<a id="user-content-wiretree-folderpath-" class="anchor" href="#wiretree-folderpath-" aria-hidden="true"><span class="octicon octicon-link"></span></a>Wiretree( folderPath )</h3>

<p>Wiretree constructor.
Creates new tree</p>

<p><strong>Parameters:</strong></p>

<ul class="task-list">
<li>
<strong>folderPath</strong> <em>String</em>: path to root folder</li>
</ul>

<p>Example:</p>

<pre><code class="language-javascript">var Wiretree = require('wiretree');
var tree = new Wiretree( 'path/to/rootFolder');</code></pre>


<p><a name="user-content-then"></a></p>

<h3>
<a id="user-content-then-fn-" class="anchor" href="#then-fn-" aria-hidden="true"><span class="octicon octicon-link"></span></a>then( fn )</h3>

<p>Executes a function and then return the tree</p>

<p><strong>Parameters:</strong></p>

<ul class="task-list">
<li>
<strong>fn</strong> <em>Function</em>: function</li>
<li>
<strong>Return</strong> <em>Object</em>: tree</li>
</ul>

<p>Example:</p>

<pre><code class="language-javascript">tree
.add('mod', 1)
.then( function () {
    console.log( 'mod is added!');
})
.add(.....)
........</code></pre>


<p><a name="user-content-add"></a></p>

<h3>
<a id="user-content-add-key-value-options-" class="anchor" href="#add-key-value-options-" aria-hidden="true"><span class="octicon octicon-link"></span></a>add( key, value, options )</h3>

<p>Add a module or wiretree plugin into the tree.
Returns tree object</p>

<p><strong>Parameters:</strong></p>

<ul class="task-list">
<li>
<strong>key</strong> <em>String</em>: name for the plugin</li>
<li>
<strong>value</strong> <em>Number|String|Boolean|Object|Function</em>: plugin</li>
<li>
<strong>options</strong> <em>Object</em>: (optional) see options</li>
<li>
<strong>Return</strong> <em>Object</em>: tree</li>
</ul>

<p>All options are optional:</p>

<ul class="task-list">
<li>
<strong><code>group</code></strong> <em>String</em>: group to add the plugin</li>
<li>
<strong><code>localname</code></strong> <em>Function</em>: keyname into its group. Only works when group is passed</li>
<li>
<strong><code>hidden</code></strong> <em>Boolean</em>: expose only in group, not in tree root. Only works when group is passed</li>
</ul>

<p><strong>Example</strong>:</p>


<pre><code class="language-javascript">// add a simple module
tree.add( 'one', 1 );
// now 'one' in tree equals 1

// add a Wiretree plugin (a module with dependencies from tree)
.add( 'plugin', {
    wiretree: function (one) {
        return one() + 2;
    }
});
// now 'plugin in tree equals 3'</code></pre>

<p><strong>Async plugin example</strong>:</p>

<p>Expose plugin through 'wtDone' dependency instead returning it from function</p>

<pre><code class="language-javascript">tree.add( 'asyncPlugin', {
    wiretree: function (wtDone) {
        doSomethingAsync( function (value) {
            wtDone( value );
        });
    }
});</code></pre>


<p><strong>Group example</strong>:</p>

<p>Passing a <code>group</code> will add the module to it. <code>localName</code> is how plugin will be exposed as into the group. <code>localName</code> is passed <code>key</code> by default</p>

<pre><code class="language-javascript">tree.add( 'homeCtrl', 1, {
    group: 'control',
    localname: 'home'
});
// plugin is exposed as 'homeCtrl' in main tree, and as 'home' in 'control' group
// so you can inject it into other modules through main tree:
var otherPlugin = function (homeCtrl) {
    // do something with homeCtrl
};
// or through its group:
var anotherPlugin = function (control) {
var homeCtrl = control.home;
    // do something with homeCtrl
};</code></pre>

<p><a name="user-content-load"></a></p>

<h3>
<a id="user-content-load-filepath-options-" class="anchor" href="#load-filepath-options-" aria-hidden="true"><span class="octicon octicon-link"></span></a>load( filePath, options )</h3>

<p>Add a plugin to tree from a file</p>

<p><strong>Parameters:</strong></p>

<ul class="task-list">
<li>
<strong>filePath</strong> <em>String</em>: path to js file</li>
<li>
<strong>options</strong> <em>Object</em>: exposing options. See <strong>options</strong> below</li>
<li>
<strong>Return</strong> <em>Object</em>: tree</li>
</ul>

<p><em>Options:</em></p>

<ul class="task-list">
<li>
<strong><code>key</code></strong> <em>String</em>: use this value instead filename as plugin keyname in main tree.</li>
<li>
<strong><code>group</code></strong> <em>String</em>: group to add the plugin</li>
<li>
<strong><code>localname</code></strong> <em>String</em>: use this value as keyname into its group. (Only works when group is passed)</li>
<li>
<strong><code>hidden</code></strong> <em>Boolean</em>: expose only in group, not in tree root. (Only works when group is passed)</li>
</ul>

<p>Add the plugin as 'user' into the tree:</p>

<pre><code class="language-javascript">tree.load( './user.js');</code></pre>

<p>Add the plugin as 'userCtrl' into the tree and as 'user' into 'controllers' group:</p>

<pre><code class="language-javascript">tree.load( './user.js', {
    key: 'userCtrl'
    group: 'controllers',
    localname: 'user'
});</code></pre>


<p><a name="user-content-folder"></a></p>

<h3>
<a id="user-content-folder-folderpath-options-" class="anchor" href="#folder-folderpath-options-" aria-hidden="true"><span class="octicon octicon-link"></span></a>folder( folderPath, options )</h3>

<p>Load every javascript file in <code>folderPath</code>.</p>

<p><strong>Parameters:</strong></p>

<ul class="task-list">
<li>
<strong>folderPath</strong> <em>String</em>: path to folder</li>
<li>
<strong>options</strong> <em>Object</em>: All options are optional. See options below</li>
<li>
<strong>Return</strong> <em>Object</em>: tree</li>
</ul>

<p><em>Options</em>:</p>

<ul class="task-list">
<li>
<strong><code>group</code></strong> <em>String</em>: group to add the plugin</li>
<li>
<strong><code>transform</code></strong> <em>Function</em>: get keyname passed as argument and return new keyname</li>
<li>
<strong><code>prefix</code></strong> <em>String</em>: add prefix to keyname</li>
<li>
<strong><code>suffix</code></strong> <em>String</em>: add suffix to keyname</li>
<li>
<strong><code>hidden</code></strong> <em>Boolean</em>: expose only in group, not in tree root. Only works when group is passed</li>
</ul>

<p>Example: load all javascript files in 'controllers' folder into 'controllers' group and expose them in main tree with 'Ctrl' suffix</p>

<pre><code class="language-javascript">tree.load( './controllers', {
    group: 'controllers',
    suffix: 'Ctrl'
});</code></pre>

<p><a name="user-content-resolve"></a></p>

<h3>
<a id="user-content-resolve-callback-" class="anchor" href="#resolve-callback-" aria-hidden="true"><span class="octicon octicon-link"></span></a>resolve( callback )</h3>

<p>Resolve all plugins and launch callback</p>

<p><strong>Parameters:</strong></p>

<ul class="task-list">
<li>
<strong>callback</strong> <em>Function</em>: to do after resolve tree</li>
</ul>

<p>Example:</p>

<pre><code class="language-javascript">tree
.folder('./my_folder')
.resolve( function () {
    console.log( 'App is running!' );
});</code></pre>

<h2>
<a id="user-content-tests" class="anchor" href="#tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tests</h2>

<pre class="pretty"><code>npm install &amp;&amp; npm test</code></pre>

<h2>
<a id="user-content-build-api-docs" class="anchor" href="#build-api-docs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build API docs</h2>

<pre class="pretty"><code>npm install &amp;&amp; npm run build-docs</code></pre>

<p><br><br></p>

<hr>

<p>© 2015 Jacobo Tabernero - <a href="http://jacoborus.codes">jacoborus</a></p>

<p>Released under <a href="https://raw.github.com/jacoborus/wiretree/master/LICENSE">MIT License</a></p>
</article><script src="js/main.js"></script>

<script src="js/vendor/prism.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48282158-2', 'auto');
  ga('send', 'pageview');

</script>

<!-- Place this tag right after the last button or just before your close body tag. -->
<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
</body>
</html>
